<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>ì‚¬ì§„ ìˆ˜ì •</title>
    <link rel="stylesheet" th:href="@{/css/style.css}">
</head>
<body>
    <div th:replace="~{fragments/sidebar :: sidebar}"></div>
    
    <div class="main-container">
        <div th:replace="~{fragments/header :: header}"></div>
        
        <div class="write-container">
            <h2>ğŸ“¸ ì‚¬ì§„ ìˆ˜ì •í•˜ê¸°</h2>
            
            <form th:action="@{/photoboard/photoboard_modify_pro}" method="post" enctype="multipart/form-data">
                <input type="hidden" name="idx" th:value="${photo.idx}">
                <input type="hidden" name="page" th:value="${page}">
            	<div class="input-group">
				    <label>ë¶„ë¥˜</label>
				    <select name="category" class="search-select">
				        <option value="ì¡ë‹´" th:selected="${photo?.category == 'ì¡ë‹´'}">ì¡ë‹´</option>
				        <option value="ì§ˆë¬¸" th:selected="${photo?.category == 'ì§ˆë¬¸'}">ì§ˆë¬¸</option>
				    </select>
				</div>
                <div class="input-group">
                    <label>ì œëª©</label>
                    <input type="text" name="title" th:value="${photo.title}" required placeholder="ì œëª©ì„ ì…ë ¥í•´ì£¼ì„¸ìš”">
                </div>
            
                <div class="input-group">
                    <label>ë‚´ìš©</label>
                    <textarea name="content" required placeholder="ê°„ë‹¨í•œ ë‚´ìš©ì„ ì ì–´ì£¼ì„¸ìš”">[[${photo.content}]]</textarea>
                </div>
            
                <div class="input-group">
                    <label>ì‚¬ì§„ ë³€ê²½</label>
                    <div class="file-upload-box">
                        <input type="file" name="file" onchange="previewImage(this)">
                        <p th:if="${photo.photo != null}" style="font-size: 0.85rem; color: #888; margin-top: 10px;">
                            í˜„ì¬ íŒŒì¼: <strong th:text="${photo.photo}">íŒŒì¼ëª…</strong>
                        </p>
                        <img id="image-preview" src="#" alt="ë¯¸ë¦¬ë³´ê¸°" />
                    </div>
                </div>
            
                <div class="input-group">
                    <label>ìˆ˜ì • ë¹„ë°€ë²ˆí˜¸</label>
                    <input type="password" name="pass" required placeholder="ì‘ì„± ì‹œ ì„¤ì •í•œ ë¹„ë°€ë²ˆí˜¸ë¥¼ ì…ë ¥í•´ ì£¼ì„¸ìš”">
                </div>
            
                <div class="btn-group">
                    <button type="submit" class="btn-submit">ìˆ˜ì • ì™„ë£Œ</button>
                    <button type="button" class="btn-cancel" 
                            th:onclick="|location.href='/photoboard/photoboard_view?idx=${photo.idx}&page=${page}'|">ì·¨ì†Œ</button>
                </div>
            </form>
        </div>
    </div>

    <script>
        function previewImage(input) {
            const preview = document.getElementById('image-preview');
            if (input.files && input.files[0]) {
                const reader = new FileReader();
                reader.onload = e => { 
                    preview.src = e.target.result; 
                    preview.style.display = 'block'; 
                };
                reader.readAsDataURL(input.files[0]);
            }
        }
    </script>
</body>
</html>